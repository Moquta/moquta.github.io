<main class="grid-container p-3">
  <section class="header p-4 shadow-2">
    <img
      [src]="settings.MasjidLogoSrc"
      alt="Masjid Logo"
      routerLink="/settings"
      style="height: 150px; width: 150px"
    />
    <div class="header__masjid-name">
      <span class="text-5xl font-bold">{{ settings.MasjidName }}</span>
      <span class="text-5xl text-black-alpha-60">
        {{ settings.MasjidSubheader }}
      </span>
    </div>
  </section>

  <section class="date-g p-4 shadow-2">
    <ng-container *ngIf="prayerData; else loading">
      <span class="text-6xl">{{ prayerData.date.gregorian.month.en }}</span>
      <span class="text-6xl">{{ prayerData.date.gregorian.day }}</span>
      <span class="text-6xl">{{ prayerData.date.gregorian.year }}</span>
    </ng-container>
  </section>

  <section class="day p-4 shadow-2">
    <span class="text-6xl">{{ now | date : "EEEE" }}</span>
  </section>

  <section class="time p-4 shadow-2">
    <span class="text-6xl">{{ now | date : "h:mm:ss a" }}</span>
  </section>

  <section class="date-h p-4 shadow-2">
    <ng-container *ngIf="prayerData; else loading">
      <span class="text-6xl">{{ prayerData.date.hijri.month.ar }}</span>
      <span class="text-6xl">{{ prayerData.date.hijri.day }}</span>
      <span class="text-6xl">{{ prayerData.date.hijri.year }}</span>
    </ng-container>
  </section>

  <section class="prayers p-4 shadow-2">
    <ng-container *ngIf="prayerData; else loading">
      <div class="prayers__row">
        <span>Prayer</span>
        <span>Adhan</span>
        <span>Iqamah</span>
      </div>
      <div
        class="prayers__row shadow-3"
        [ngClass]="{
          'prayers__row--highlighted shadow-7': nextPrayerIndex === 0
        }"
        [ngStyle]="
          nextPrayerIndex === 0
            ? {
                'background-color': settings.MasjidPrimaryColor,
                color: settings.MasjidSecondaryColor
              }
            : null
        "
      >
        <span>Fajr</span>
        <span>{{ formatAdhanTime(prayerData.timings.Fajr) }}</span>
        <span>
          {{
            calcIqamaTime(prayerData.timings.Fajr, settings.IqamaTimings.Fajr)
          }}
        </span>
      </div>
      <div
        class="prayers__row shadow-3"
        [ngClass]="{
          'prayers__row--highlighted shadow-7': nextPrayerIndex === 1
        }"
        [ngStyle]="
          nextPrayerIndex === 1
            ? {
                'background-color': settings.MasjidPrimaryColor,
                color: settings.MasjidSecondaryColor
              }
            : null
        "
      >
        <span>Sunrise</span>
        <span>{{ formatAdhanTime(prayerData.timings.Sunrise) }}</span>
      </div>
      <div
        class="prayers__row shadow-3"
        [ngClass]="{
          'prayers__row--highlighted shadow-7': nextPrayerIndex === 2
        }"
        [ngStyle]="
          nextPrayerIndex === 2
            ? {
                'background-color': settings.MasjidPrimaryColor,
                color: settings.MasjidSecondaryColor
              }
            : null
        "
      >
        <span>Dhuhr</span>
        <span>{{ formatAdhanTime(prayerData.timings.Dhuhr) }}</span>
        <span>
          {{
            calcIqamaTime(prayerData.timings.Dhuhr, settings.IqamaTimings.Dhuhr)
          }}
        </span>
      </div>
      <div
        class="prayers__row shadow-3"
        [ngClass]="{
          'prayers__row--highlighted shadow-7': nextPrayerIndex === 3
        }"
        [ngStyle]="
          nextPrayerIndex === 3
            ? {
                'background-color': settings.MasjidPrimaryColor,
                color: settings.MasjidSecondaryColor
              }
            : null
        "
      >
        <span>Asr</span>
        <span>{{ formatAdhanTime(prayerData.timings.Asr) }}</span>
        <span>
          {{ calcIqamaTime(prayerData.timings.Asr, settings.IqamaTimings.Asr) }}
        </span>
      </div>
      <div
        class="prayers__row shadow-3"
        [ngClass]="{
          'prayers__row--highlighted shadow-7': nextPrayerIndex === 4
        }"
        [ngStyle]="
          nextPrayerIndex === 4
            ? {
                'background-color': settings.MasjidPrimaryColor,
                color: settings.MasjidSecondaryColor
              }
            : null
        "
      >
        <span>Maghrib</span>
        <span>{{ formatAdhanTime(prayerData.timings.Maghrib) }}</span>
        <span>
          {{
            calcIqamaTime(
              prayerData.timings.Maghrib,
              settings.IqamaTimings.Maghrib
            )
          }}
        </span>
      </div>
      <div
        class="prayers__row shadow-3"
        [ngClass]="{
          'prayers__row--highlighted shadow-7': nextPrayerIndex === 5
        }"
        [ngStyle]="
          nextPrayerIndex === 5
            ? {
                'background-color': settings.MasjidPrimaryColor,
                color: settings.MasjidSecondaryColor
              }
            : null
        "
      >
        <span>Isha</span>
        <span>{{ formatAdhanTime(prayerData.timings.Isha) }}</span>
        <span>
          {{
            calcIqamaTime(prayerData.timings.Isha, settings.IqamaTimings.Isha)
          }}
        </span>
      </div>
    </ng-container>
  </section>

  <section
    class="additional-info p-4 shadow-2"
    [ngStyle]="
      today.getDay() === 5 && nextPrayerIndex === 2
        ? {
            'background-color': settings.MasjidPrimaryColor,
            color: settings.MasjidSecondaryColor
          }
        : null
    "
  >
    <span *ngFor="let info of settings.AdditionalInfo" class="text-7xl">
      {{ info }}
    </span>
  </section>
</main>

<ng-template #loading>
  <div class="loading-spinner">
    <mat-spinner></mat-spinner>
  </div>
</ng-template>
